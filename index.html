<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Senarai Staf</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    select { padding: 5px; font-size: 14px; margin-bottom: 15px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>Senarai Staf</h2>

  <!-- Combo box -->
  <label for="staffSelect">Pilih Nama Staf:</label>
  <select id="staffSelect">
    <option value="">-- Pilih --</option>
  </select>

  <!-- Jadual hasil carian -->
  <table id="resultTable" style="display:none;">
    <thead>
      <tr>
        <th>Nama Staf</th>
        <th>Jawatankuasa</th>
        <th>Jumlah Pemberat</th>
      </tr>
    </thead>
    <tbody id="resultBody"></tbody>
  </table>

  <script>
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyB51yXVYq6pcRvePVPMgYAxhvlp86_PyC4WPvnCJM_iX8V08ePbWAbuv1MusQO4NiMFA/exec"; // ganti dgn URL Apps Script

    let allData = [];

    // Ambil data dari Google Sheets
    async function loadData() {
      const res = await fetch(APPS_SCRIPT_URL);
      allData = await res.json();

      // Isi dropdown dengan senarai Nama Staf
      const staffSelect = document.getElementById("staffSelect");
      let names = [...new Set(allData.map(row => row["Nama Staf"]))]; // buang duplicate
      names.forEach(name => {
        let option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        staffSelect.appendChild(option);
      });
    }

    // Bila pilih staf dari combo box
    document.getElementById("staffSelect").addEventListener("change", function() {
      const selectedName = this.value;
      const resultBody = document.getElementById("resultBody");
      const resultTable = document.getElementById("resultTable");

      resultBody.innerHTML = "";

      if (selectedName) {
        const staffData = allData.filter(row => row["Nama Staf"] === selectedName);

        staffData.forEach(row => {
          let tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row["Nama Staf"]}</td>
            <td>${row["Jawatankuasa"]}</td>
            <td>${row["Jumlah Pemberat"]}</td>
          `;
          resultBody.appendChild(tr);
        });

        resultTable.style.display = "table";
      } else {
        resultTable.style.display = "none";
      }
    });

    // Load data bila page buka
    loadData();
  </script>
</body>
</html>

