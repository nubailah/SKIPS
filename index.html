<!DOCTYPE html>
<html>
<head>
  <title>Laporan Staf</title>
</head>
<body>
  <h2>Senarai Staf</h2>
  
  <label>Pilih staf:</label>
  <select id="staffSelect"></select>

  <div id="result"></div>

  <script>
    async function loadData() {
      let response = await fetch("https://script.google.com/macros/s/AKfycbyqPy1dyWf1UTmwZ6oj_XpFf4h1Tq24yQLECTQlhjm76EMzsaAyJ9F1jkiBBNsiP5-nUw/exec");
      let data = await response.json();

      let select = document.getElementById("staffSelect");
      select.innerHTML = "<option value=''>--Pilih Nama Staf--</option>";

      data.forEach(staff => {
        let option = document.createElement("option");
        option.value = staff.nama;
        option.textContent = staff.nama;
        select.appendChild(option);
      });

      select.onchange = function() {
        let chosen = data.find(s => s.nama === this.value);
        if (chosen) {
          let details = `
            <p><b>Nama:</b> ${chosen.nama}</p>
            <p><b>Total Pemberat:</b> ${chosen.totalPemberat}</p>
            <h3>Butiran Portfolio:</h3>
            <ul>
          `;
          chosen.rekod.forEach(r => {
            details += `<li>${r.kod} - ${r.portfolio} (${r.jawatan}) â†’ Pemberat: ${r.pemberat}</li>`;
          });
          details += "</ul>";

          document.getElementById("result").innerHTML = details;
        } else {
          document.getElementById("result").innerHTML = "";
        }
      };
    }

    loadData();
  </script>
</body>
</html>
