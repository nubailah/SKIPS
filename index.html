
<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <title>Laporan Jawatankuasa</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input { padding: 8px; margin-bottom: 10px; width: 250px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>
  <h2>Laporan Jawatankuasa</h2>

  <input type="text" id="search" placeholder="Cari nama staf...">

  <table id="dataTable">
    <thead>
      <tr>
        <th>Nama Staf</th>
        <th>Jawatankuasa</th>
        <th>Jumlah Pemberat</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzDcfLFQl-gTWAtfkweqSNIdl2cGm7y-1p_lpkBqD4t8RBSe2ppHirEiUx4S8K96lyHgw/exec
"; // ganti dengan URL Web App cikgu

    async function loadData() {
      try {
        const res = await fetch(APPS_SCRIPT_URL);
        const data = await res.json();
        renderTable(data);

        // fungsi carian
        document.getElementById("search").addEventListener("input", (e) => {
          const keyword = e.target.value.toLowerCase();
          const filtered = data.filter(row => 
            row["Nama Staf"]?.toLowerCase().includes(keyword)
          );
          renderTable(filtered);
        });

      } catch (err) {
        console.error("Error fetching data:", err);
      }
    }

    function renderTable(data) {
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row["Nama Staf"] || ""}</td>
          <td>${row["Jawatankuasa"] || ""}</td>
          <td>${row["Jumlah Pemberat"] || ""}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // auto refresh setiap 1s
    setInterval(loadData, 1000);

    // load kali pertama
    loadData();
  </script>
</body>
</html>


